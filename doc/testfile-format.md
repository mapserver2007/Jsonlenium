# Jsonleniumテストファイルの仕様について

## url
| 型     | 必須/任意 | 制約 |
|--------|-----------|------|
| string | 必須      | なし |

```json
"url": "http://kakaku.com/"
```

## testcase
| 型    | 必須/任意 | 制約                                                                                                                                                     |
|-------|-----------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| array | 任意      | 省略可能だが定義時は要素が1つ以上必要<br> 配列で指定<br> 以下の要素が配下に指定可能<br> selector/attr/expect/expect_all/not_expect/not_expect_all/remark |

```json
"testcase": [
    {
        "selector": "title",
        "expect": "価格.com - 「買ってよかった」をすべてのひとに。"
    }
]
```

## selector
| 型     | 必須/任意    | 制約                                                               |
|--------|--------------|--------------------------------------------------------------------|
| string | 条件付き必須 | testcase要素配下で指定、testcase指定時は必須<br> CSSセレクタを指定 |

```json
"selector": "div#content > span.num"
```

## xpath
| 型     | 必須/任意    | 制約                                                                 |
|--------|--------------|----------------------------------------------------------------------|
| string | 条件付き必須 | testcase要素配下で指定、testcase指定時は必須<br> XPathを指定 |

```json
"xpath": "//*[@id='result']"
```

## jsonpath
| 型     | 必須/任意    | 制約                                                            |
|--------|--------------|-----------------------------------------------------------------|
| string | 条件付き必須 | testcase要素配下で指定、testcase指定時は必須<br> JsonPathを指定 |


```json
"jsonpath": "$..result"
```

## name
| 型     | 必須/任意 | 制約                        |
|--------|-----------|-----------------------------|
| string | 任意      | catalyst,meta,k3c配下で指定 |

```json
"meta": [
    {
      "name": "robots",
      "expect": "index,follow"
    }
]
```

## attr
| 型     | 必須/任意 | 制約                                                                    |
|--------|-----------|-------------------------------------------------------------------------|
| string | 任意      | testcase要素配下で指定<br> 指定した場合、HTMLの属性値をテスト対象にする |

```json
"testcase": [
    {
        "selector": "link[rel='canonical']",
        "attr": "href",
        "expect": "actual"
    }
]
```

## click
| 型     | 必須/任意 | 制約                                                                                                                                                                        |
|--------|-----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| object | 任意      | testcase要素配下で指定<br> selectorで指定した要素に対してclickイベントを実行する<br> Ajaxを含む処理にも対応<br> 入れ子の指定が可能で、連続でclickイベントを起こすことが可能 |

```json
"testcase": [
    {
        "selector": "selector1",
        "click": {
            "selector": "selector2",
            "expect": "actual"
        }
    }
]
```

## case_sensitive
| 型      | 必須/任意 | 制約                                                                                                                                                                                        |
|---------|-----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| boolean | 任意      | 検査結果値の大文字と小文字を区別をしない<br> falseを設定すると大文字、小文字を区別しないで評価する<br> 省略可能で、省略時はtrue<br> 以下の要素配下で指定可能<br> testcase/meta/catalyst/k3c |

```json
"testcase": [
    {
        "selector": "link[rel='canonical']",
        "attr": "href",
        "case_sensitive": true,
        "expect": "actual"
    }
]
```

## remark
| 型     | 必須/任意 | 制約                                                                                                     |
|--------|-----------|----------------------------------------------------------------------------------------------------------|
| string | 任意      | すべての階層で指定可能<br> テストケースにコメントを付けたい場合に使用する<br> テスト実行結果に影響しない |

```json
"testcase": [
    {
        "selector": "title",
        "remark": "コメント自由記述",
        "expect": "価格.com - 「買ってよかった」をすべてのひとに。"
    }
]
```

## input
| 型    | 必須/任意 | 制約                                                                                                                                                                                                                                             |
|-------|-----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| array | 任意      | testcase要素配下またはclick要素配下で指定可能<br> input配下に指定したvalueの値をselectorで指定した要素に入力する<br> input配下の要素数の上限なし<br> inputで指定した内容は入力のみ行うため、submitしたい場合はinputと同階層にclick要素を指定する |

```json
"testcase": [
    {
        "selector": "#submit_button",
        "input": [
            {
                "selector": "#name",
                "value": "test"
            },
            {
                "selector": "#age",
                "value": "17"
            }
        ],
        "click": {
            "selector": "title",
            "expect": "actual"
        }
    }
]
```

## expect
| 型     | 必須/任意    | 制約                                                                                                                                                         |
|--------|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| string | 条件付き必須 | testcase要素配下で指定<br> テストする値を指定<br> /～/ で指定した場合、正規表現によるマッチ<br> 複数の要素がマッチする場合、いずれかマッチでテスト成功になる |

```json
"testcase": [
    {
        "selector": "selector1",
        "expect": "actual"
    }
]
```

```json
"testcase": [
    {
        "selector": "selector1",
        "expect": /actu.+/"
    }
]
```

## expect_all
| 型     | 必須/任意    | 制約                                                                                                                                                                                       |
|--------|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| string | 条件付き必須 | testcase要素配下で指定、testcase指定時は必須<br> テストする値を指定<br> /～/ で指定した場合、正規表現によるマッチ<br> 複数の要素がマッチする場合、すべてマッチしたときのみテスト成功になる |

```json
"testcase": [
    {
        "selector": "selector1",
        "expect_all": "actual"
    }
]
```

```json
"testcase": [
    {
        "selector": "selector1",
        "expect_all": /actu.+/"
    }
]
```

## not_expect
| 型     | 必須/任意    | 制約                                                                                                                                                                                                                                   |
|--------|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| string | 条件付き必須 | testcase要素配下で指定<br> テストする値を指定<br> /～/ で指定した場合、正規表現によるマッチ<br> xpath, selectorに対する要素が1つもマッチしない場合テスト成功<br> 複数の要素がマッチする場合、マッチしないものが1つ以上あればテスト成功 |

```json
"testcase": [
    {
        "selector": "selector1",
        "not_expect": "not_actual"
    }
]
```

```json
"testcase": [
    {
        "selector": "selector1",
        "not_expect": /not_actu.+/"
    }
]
```

## not_expect_all
| 型     | 必須/任意    | 制約                                                                                                                                                          |
|--------|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| string | 条件付き必須 | testcase要素配下で指定<br> テストする値を指定<br> /～/ で指定した場合、正規表現によるマッチ<br> xpath, selectorに対する要素がすべてマッチしない場合テスト成功 |

```json
"testcase": [
    {
        "selector": "selector1",
        "not_expect_all": "not_actual"
    }
]
```

```json
"testcase": [
    {
        "selector": "selector1",
        "not_expect_all": /not_actu.+/"
    }
]
```

## catalyst
| 型     | 必須/任意 | 制約                                                                                                                                                             |
|--------|-----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| array  | 任意      | SiteCatalyst専用機能<br> 省略可能だが定義時は要素が1つ以上必要<br> 配列で指定<br> 以下の要素が配下に指定可能<br> name/expect<br> ※「s.」は省略可能(付けても良い) |

```json
"catalyst": [
    {
        "name": "prop1",
        "expect": "actual"
    }
]
```

```json
"catalyst": [
    {
        "name": "s.prop1",
        "expect": "actual"
    }
]
```

## meta
| 型    | 必須/任意 | 制約                                                                                                    |
|-------|-----------|---------------------------------------------------------------------------------------------------------|
| array | 任意      | 省略可能だが定義時は要素が1つ以上必要<br> 配列で指定<br> 以下の要素が配下に指定可能<br> selector/expect |

```json
"meta": [
    {
        "name": "robots",
        "expect": "index,follow"
    }
]
```